package com.cheuks.bin.original.test;

import java.math.BigDecimal;

import com.google.gson.Gson;
import com.google.gson.JsonArray;
import com.google.gson.JsonElement;
import com.google.gson.JsonParser;

public class JsonTest {

	private static String a = "[{\"amount\":118.8,\"voucher_type\":\"EA\",\"voucher_id\":\"1524023\",\"invoice_maker\":null,\"tax_amount\":0,\"lock_return_code\":\"143907144771915776|143907142871896064\",\"invoice_date\":null,\"order_return_code\":\"PO2017052536524\",\"invoice_num\":null,\"order_type\":\"YP\",\"source_system\":\"MALL\",\"tax_rate\":null},{\"amount\":30.4,\"voucher_type\":\"EA\",\"voucher_id\":\"1524024\",\"invoice_maker\":null,\"tax_amount\":0,\"lock_return_code\":\"143907144780304384|143907142871896064\",\"invoice_date\":null,\"order_return_code\":\"PO2017052536524\",\"invoice_num\":null,\"order_type\":\"YP\",\"source_system\":\"MALL\",\"tax_rate\":null},{\"amount\":25.92,\"voucher_type\":\"EA\",\"voucher_id\":\"1524025\",\"invoice_maker\":null,\"tax_amount\":0,\"lock_return_code\":\"143907144792887296|143907142871896064\",\"invoice_date\":null,\"order_return_code\":\"PO2017052536524\",\"invoice_num\":null,\"order_type\":\"YP\",\"source_system\":\"MALL\",\"tax_rate\":null},{\"amount\":75.5,\"voucher_type\":\"EA\",\"voucher_id\":\"1524027\",\"invoice_maker\":null,\"tax_amount\":0,\"lock_return_code\":\"143907144801275904|143907142871896064\",\"invoice_date\":null,\"order_return_code\":\"PO2017052536524\",\"invoice_num\":null,\"order_type\":\"YP\",\"source_system\":\"MALL\",\"tax_rate\":null},{\"amount\":84.61,\"voucher_type\":\"EA\",\"voucher_id\":\"1524026\",\"invoice_maker\":null,\"tax_amount\":0,\"lock_return_code\":\"143907144797081600|143907142871896064\",\"invoice_date\":null,\"order_return_code\":\"PO2017052536524\",\"invoice_num\":null,\"order_type\":\"YP\",\"source_system\":\"MALL\",\"tax_rate\":null},{\"amount\":238.5,\"voucher_type\":\"EA\",\"voucher_id\":\"1514664\",\"invoice_maker\":null,\"tax_amount\":0,\"lock_return_code\":\"140918840526983168|140918837330923520\",\"invoice_date\":null,\"order_return_code\":\"PO2017051768964\",\"invoice_num\":null,\"order_type\":\"YP\",\"source_system\":\"MALL\",\"tax_rate\":null},{\"amount\":238.5,\"voucher_type\":\"EA\",\"voucher_id\":\"1514665\",\"invoice_maker\":null,\"tax_amount\":0,\"lock_return_code\":\"140918840535371776|140918837330923520\",\"invoice_date\":null,\"order_return_code\":\"PO2017051768964\",\"invoice_num\":null,\"order_type\":\"YP\",\"source_system\":\"MALL\",\"tax_rate\":null},{\"amount\":105.96,\"voucher_type\":\"EA\",\"voucher_id\":\"1508878\",\"invoice_maker\":null,\"tax_amount\":0,\"lock_return_code\":\"138804206604996608|138804204751114240\",\"invoice_date\":null,\"order_return_code\":\"PO2017051101269\",\"invoice_num\":null,\"order_type\":\"YP\",\"source_system\":\"MALL\",\"tax_rate\":null},{\"amount\":8.55,\"voucher_type\":\"EA\",\"voucher_id\":\"1508875\",\"invoice_maker\":null,\"tax_amount\":0,\"lock_return_code\":\"138804206588219392|138804204751114240\",\"invoice_date\":null,\"order_return_code\":\"PO2017051101269\",\"invoice_num\":null,\"order_type\":\"YP\",\"source_system\":\"MALL\",\"tax_rate\":null},{\"amount\":13.64,\"voucher_type\":\"EA\",\"voucher_id\":\"1508876\",\"invoice_maker\":null,\"tax_amount\":0,\"lock_return_code\":\"138804206596608000|138804204751114240\",\"invoice_date\":null,\"order_return_code\":\"PO2017051101269\",\"invoice_num\":null,\"order_type\":\"YP\",\"source_system\":\"MALL\",\"tax_rate\":null},{\"amount\":16.19,\"voucher_type\":\"EA\",\"voucher_id\":\"1508877\",\"invoice_maker\":null,\"tax_amount\":0,\"lock_return_code\":\"138804206600802304|138804204751114240\",\"invoice_date\":null,\"order_return_code\":\"PO2017051101269\",\"invoice_num\":null,\"order_type\":\"YP\",\"source_system\":\"MALL\",\"tax_rate\":null},{\"amount\":15.92,\"voucher_type\":\"EA\",\"voucher_id\":\"1508879\",\"invoice_maker\":null,\"tax_amount\":0,\"lock_return_code\":\"138804206609190912|138804204751114240\",\"invoice_date\":null,\"order_return_code\":\"PO2017051101269\",\"invoice_num\":null,\"order_type\":\"YP\",\"source_system\":\"MALL\",\"tax_rate\":null},{\"amount\":33.84,\"voucher_type\":\"EA\",\"voucher_id\":\"1509507\",\"invoice_maker\":null,\"tax_amount\":0,\"lock_return_code\":\"138887345725591552|138887343469056000\",\"invoice_date\":null,\"order_return_code\":\"PO2017051123084\",\"invoice_num\":null,\"order_type\":\"YP\",\"source_system\":\"MALL\",\"tax_rate\":null},{\"amount\":4.23,\"voucher_type\":\"EA\",\"voucher_id\":\"1509508\",\"invoice_maker\":null,\"tax_amount\":0,\"lock_return_code\":\"138887345729785856|138887343469056000\",\"invoice_date\":null,\"order_return_code\":\"PO2017051123084\",\"invoice_num\":null,\"order_type\":\"YP\",\"source_system\":\"MALL\",\"tax_rate\":null},{\"amount\":22.7,\"voucher_type\":\"EA\",\"voucher_id\":\"1509509\",\"invoice_maker\":null,\"tax_amount\":0,\"lock_return_code\":\"138887345733980160|138887343469056000\",\"invoice_date\":null,\"order_return_code\":\"PO2017051123084\",\"invoice_num\":null,\"order_type\":\"YP\",\"source_system\":\"MALL\",\"tax_rate\":null},{\"amount\":8.16,\"voucher_type\":\"EA\",\"voucher_id\":\"1509510\",\"invoice_maker\":null,\"tax_amount\":0,\"lock_return_code\":\"138887345742368768|138887343469056000\",\"invoice_date\":null,\"order_return_code\":\"PO2017051123084\",\"invoice_num\":null,\"order_type\":\"YP\",\"source_system\":\"MALL\",\"tax_rate\":null},{\"amount\":13.16,\"voucher_type\":\"EA\",\"voucher_id\":\"1509511\",\"invoice_maker\":null,\"tax_amount\":0,\"lock_return_code\":\"138887345750757376|138887343469056000\",\"invoice_date\":null,\"order_return_code\":\"PO2017051123084\",\"invoice_num\":null,\"order_type\":\"YP\",\"source_system\":\"MALL\",\"tax_rate\":null},{\"amount\":24.15,\"voucher_type\":\"EA\",\"voucher_id\":\"1509532\",\"invoice_maker\":null,\"tax_amount\":0,\"lock_return_code\":\"138887345754951680|138887343469056000\",\"invoice_date\":null,\"order_return_code\":\"PO2017051123084\",\"invoice_num\":null,\"order_type\":\"YP\",\"source_system\":\"MALL\",\"tax_rate\":null},{\"amount\":24.27,\"voucher_type\":\"EA\",\"voucher_id\":\"1509533\",\"invoice_maker\":null,\"tax_amount\":0,\"lock_return_code\":\"138887345759145984|138887343469056000\",\"invoice_date\":null,\"order_return_code\":\"PO2017051123084\",\"invoice_num\":null,\"order_type\":\"YP\",\"source_system\":\"MALL\",\"tax_rate\":null},{\"amount\":21.39,\"voucher_type\":\"EA\",\"voucher_id\":\"1509534\",\"invoice_maker\":null,\"tax_amount\":0,\"lock_return_code\":\"138887345767534592|138887343469056000\",\"invoice_date\":null,\"order_return_code\":\"PO2017051123084\",\"invoice_num\":null,\"order_type\":\"YP\",\"source_system\":\"MALL\",\"tax_rate\":null},{\"amount\":161.55,\"voucher_type\":\"EA\",\"voucher_id\":\"1509535\",\"invoice_maker\":null,\"tax_amount\":0,\"lock_return_code\":\"138887345771728896|138887343469056000\",\"invoice_date\":null,\"order_return_code\":\"PO2017051123084\",\"invoice_num\":null,\"order_type\":\"YP\",\"source_system\":\"MALL\",\"tax_rate\":null},{\"amount\":203.4,\"voucher_type\":\"EA\",\"voucher_id\":\"1505085\",\"invoice_maker\":null,\"tax_amount\":0,\"lock_return_code\":\"137996394295545856|137996392445857792\",\"invoice_date\":null,\"order_return_code\":\"PO2017050903806\",\"invoice_num\":null,\"order_type\":\"YP\",\"source_system\":\"MALL\",\"tax_rate\":null},{\"amount\":44.44,\"voucher_type\":\"EA\",\"voucher_id\":\"1497791\",\"invoice_maker\":null,\"tax_amount\":0,\"lock_return_code\":\"135536383032119296|135536380830109696\",\"invoice_date\":null,\"order_return_code\":\"PO2017050291333\",\"invoice_num\":null,\"order_type\":\"YP\",\"source_system\":\"MALL\",\"tax_rate\":null},{\"amount\":41,\"voucher_type\":\"EA\",\"voucher_id\":\"1497812\",\"invoice_maker\":null,\"tax_amount\":0,\"lock_return_code\":\"135536383057285120|135536380830109696\",\"invoice_date\":null,\"order_return_code\":\"PO2017050291333\",\"invoice_num\":null,\"order_type\":\"YP\",\"source_system\":\"MALL\",\"tax_rate\":null},{\"amount\":33.33,\"voucher_type\":\"EA\",\"voucher_id\":\"1497813\",\"invoice_maker\":null,\"tax_amount\":0,\"lock_return_code\":\"135536383065673728|135536380830109696\",\"invoice_date\":null,\"order_return_code\":\"PO2017050291333\",\"invoice_num\":null,\"order_type\":\"YP\",\"source_system\":\"MALL\",\"tax_rate\":null}]";

	public static void main(String[] args) {
		JsonParser jsonParser = new JsonParser();
		JsonArray array = jsonParser.parse(a).getAsJsonArray();
		float total = 0;
		float x = 0;
		float temp = 0;
		for (int i = 0, len = array.size(); i < len; i++) {
			if ((temp = array.get(i).getAsJsonObject().get("amount").getAsFloat()) < 0) {
				x += temp;
			} else {
				total += temp;
			}
		}
		System.out.println(x + "  : " + (total + 273.37));
		System.err.println(BigDecimal.valueOf(0D).compareTo(BigDecimal.ZERO) < 0);
		System.err.println(BigDecimal.valueOf(11D).multiply(BigDecimal.valueOf(-1D)).intValue());

		StringBuffer sql = new StringBuffer("select m.order_type,m.order_id ,m.order_id as order_code,'SMART-BUY' source_system,");
		sql.append("t.voucher_key_id,t.voucher_id,t.voucher_type,t.voucher_return_code ,t.lock_amount,t.tax_amount ");
		sql.append("from xxxxxxxxx m ");
		sql.append("left join  sm_order_balance_payment_rel r on m.id = r.relate_id ");
		sql.append("left join  sm_order_balance_payment p on  r.payment_id = p.id ");
		sql.append("left join  sm_consumer_voucher t on  m.relate_id = t.relate_id  ");
		sql.append("where p.id = ? and m.check_status = ? and r.status=? and t.lock_amount is not null");
		System.out.println(sql.toString());
	}

}
